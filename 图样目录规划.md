
## 文件需要

1. 整体BOM表格
2. 原始图纸文件
3. pdf图纸文件

## BOM表格导出

## 表格导入后处理为明细文档格式

1. 导入BOM表格
2. 定义每列格式
3. 删除不需要的列
4. 删除不需要的行
5. 新建父件相关列
    1. 父件的名称
    2. 父件的数量
    3. 总数量
6. 修正阶层因为识别为小数去除尾部的0的情况（3.10导出后被识别为3.1）
7. 根据阶层识别父件名称和数量
8. 根据零件数量和父件数量计算总数量
    1. 总数量=数量×父件的数量
    2. 根据数量的多少判断是否需要格式化显示的列
9. 清楚没有直接外购套件的零件（没有父件代号的行）
10. 将零件分类为组件、分组件、部件、分部件、零件、标准件和外购件，并排序
11. 删除多余的列
    1. 序号
    2. 父件的名称
    3. 父件的数量
    4. 分类
12. 增加排辅助排序列
13. 根据文件名称进行分组
14. 增加相同零件的汇总行,并将汇总行下面的零件名称等参数清空
15. 重新排序
16. 删除无效单元格的nan内容
17. 单独处理成品行的内容
18. 增加分类行
19. 删除多余的列
20. 重新整理列的顺序
[] 每种类别内排序还有一些问题，没有办法按照父件的代号进行优先级排序,会把相同文件名称的零件顺序搞乱

## 将明细表格导入word

1. 创建word文档
2. 复制模板文件
3. 导入模板
4. 提取excel表格数据
5. 填入文档
6. 保存文档

## 表格整理（目录）

1. 新建表格为目录表格
    1. 总共3列，“幅面”、“代号”、“页数”
2. 要求输入“图纸路径”
3. 数据判断
    1. 收集所有wh开头的“零件号”和对应“文件名称”
    2. 根据路径遍历零件号具有wh开头的零部件是否存在“相同名称”文件后缀为"drw.*"文件，其中“*”为任意长度数字
        1. 如果存在跳过
        2. 如果不存在删除
    3. 判断页数
        1. 根据明细表的行数判断明细表的页数
        2. 根据文件名称对应的pdf的页数判断图纸页数

## 填入word

1. 基础信息填入
    1. 将“WH***0000”替换为“总图代号”
    2. 将“*****雷达”替换为“总图名称”
2. 存储第二页为目录模板
3. 存储第三页为明细模板
4. 执行填入目录
    1. 第一行
5. 填入明细表

