## 文件需要
1. 整体BOM表格
2. 原始图纸文件
3. pdf图纸文件

## BOM表格导出
- [ ] 需要增加一列文件名称

| <font style="color:#000000;">序号</font> | <font style="color:#000000;"> </font><font style="color:#000000;">阶层</font> | <font style="color:#000000;">零件代号</font> | <font style="color:#000000;">零件名称</font> | <font style="color:#000000;">规格</font> | <font style="color:#000000;">数量</font> | <font style="color:#000000;">材料</font> | <font style="color:#000000;">单重(kg)</font> | <font style="color:#000000;">总重(kg)</font> | <font style="color:#000000;">备注</font> |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| <font style="color:#000000;">1</font> | <font style="color:#000000;">0</font> | <font style="color:#000000;">WHJ820000</font> | <font style="color:#000000;">蒸发波导诊断系统</font> | | <font style="color:#000000;">1</font> | | <font style="color:#000000;">56.97</font> | <font style="color:#000000;">56.97</font> | |
| <font style="color:#000000;">2</font> | <font style="color:#000000;">1</font> | <font style="color:#000000;">WHJ820000-01</font> | <font style="color:#000000;">主立杆</font> | <font style="color:#000000;">50X1500X50</font> | <font style="color:#000000;">1</font> | <font style="color:#000000;">316L</font> | <font style="color:#000000;">3.53</font> | <font style="color:#000000;">3.53</font> | |
| <font style="color:#000000;">3</font> | <font style="color:#000000;">2</font> | <font style="color:#000000;">WHJ821000</font> | <font style="color:#000000;">横杆组件</font> | | <font style="color:#000000;">1</font> | | <font style="color:#000000;">0.6</font> | <font style="color:#000000;">0.6</font> | |
| <font style="color:#000000;">4</font> | <font style="color:#000000;">2.1</font> | <font style="color:#000000;">WHJ821100</font> | <font style="color:#000000;">横杆焊接合件</font> | | <font style="color:#000000;">1</font> | | <font style="color:#000000;">0.52</font> | <font style="color:#000000;">0.52</font> | |
| <font style="color:#000000;">5</font> | <font style="color:#000000;">2.1.1</font> | <font style="color:#000000;">WHJ821100-01</font> | <font style="color:#000000;">矩形管</font> | <font style="color:#000000;">350X30X30</font> | <font style="color:#000000;">1</font> | <font style="color:#000000;">316L</font> | <font style="color:#000000;">0.44</font> | <font style="color:#000000;">0.44</font> | |
| <font style="color:#000000;">6</font> | <font style="color:#000000;">2.1.2</font> | <font style="color:#000000;">WHJ821100-02</font> | <font style="color:#000000;">横杆抱箍B</font> | <font style="color:#000000;">100X27X30</font> | <font style="color:#000000;">1</font> | <font style="color:#000000;">316L</font> | <font style="color:#000000;">0.08</font> | <font style="color:#000000;">0.08</font> | |
| <font style="color:#000000;">7</font> | <font style="color:#000000;">2.2</font> | <font style="color:#000000;">WHJ821000-01</font> | <font style="color:#000000;">横杆抱箍A</font> | <font style="color:#000000;">100X27X30</font> | <font style="color:#000000;">1</font> | <font style="color:#000000;">316L</font> | <font style="color:#000000;">0.08</font> | <font style="color:#000000;">0.08</font> | |
| <font style="color:#000000;">8</font> | <font style="color:#000000;">3</font> | <font style="color:#000000;">WHJ822000</font> | <font style="color:#000000;">箱体组件</font> | <font style="color:#000000;">XX</font> | <font style="color:#000000;">1</font> | | <font style="color:#000000;">12.69</font> | <font style="color:#000000;">12.69</font> | |
| <font style="color:#000000;">9</font> | <font style="color:#000000;">3.1</font> | <font style="color:#000000;">WHJ822100</font> | <font style="color:#000000;">箱体分组件</font> | <font style="color:#000000;">XX</font> | <font style="color:#000000;">1</font> | | <font style="color:#000000;">0.01</font> | <font style="color:#000000;">0.01</font> | <font style="color:#000000;">外购</font> |
| <font style="color:#000000;">10</font> | <font style="color:#000000;">3.1.1</font> | | <font style="color:#000000;">防水电箱</font> | <font style="color:#000000;">345X403.6X440</font> | <font style="color:#000000;">1</font> | <font style="color:#000000;">316L</font> | <font style="color:#000000;">0</font> | <font style="color:#000000;">0</font> | <font style="color:#000000;">外购</font> |


## 表格整理（明细）
1. BOM表格整理
    1. 将顶层的装配体名称和代号存储为“总图名称”“总图代号”后删除
    2. 删除规格列
    3. 删除备注为“连接器自带电缆”的行
    4. 新建2列分别存储“父件的名称”、“父件的数量”、“总数量”（总数量=数量×父件的数量）
    5. 删除数量列
2. 重新排布文件（为明细表做准备）
    1. 将代号wh***000的部件分类为组件
    2. 将代号wh****00的部件分类为分组件
    3. 将代号wh****0的部件分类为部件
    4. 将代号wh****的部件分类为分部件
    5. 将代号wh***-**的零件分类为零件
    6. 将带有GB的零件分类为标准件
    7. 将空的零件分类为外购件
3. 合并重复号的零件和部件，但是“父件的名称”和“父件的数量”需要增加行单独列出
    1. 将相同零件代号合并
    2. 将相同的零件名称合并
    3. 将相同零件代号的总数量叠加后存储为“新的数量”
    4. 将“总数量”和“父件的名称”和“父件的数量”增加行并且需要在前面增加合适的空单元格

## 表格整理（目录）
1. 新建表格为目录表格
    1. 总共3列，“幅面”、“代号”、“页数”
2. 要求输入“图纸路径”
3. 数据判断
    1. 收集所有wh开头的“零件号”和对应“文件名称”
    2. 根据路径遍历零件号具有wh开头的零部件是否存在“相同名称”文件后缀为"drw.*"文件，其中“*”为任意长度数字
        1. 如果存在跳过
        2. 如果不存在删除
    3. 判断页数
        1. 根据明细表的行数判断明细表的页数
        2. 根据文件名称对应的pdf的页数判断图纸页数

## 填入word
1. 基础信息填入
    1. 将“WH***0000”替换为“总图代号”
    2. 将“*****雷达”替换为“总图名称”
2. 存储第二页为目录模板
3. 存储第三页为明细模板
4. 执行填入目录
    1. 第一行
5. 填入明细表

